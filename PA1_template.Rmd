# Reproducible Research: Peer Assessment 1

##Loading required libraries
```{r Loading libraries}
#install.packages("ggplot2")
library(ggplot2)
library(knitr)
```
## Loading and preprocessing the data
```{r loading data}
acdat <-  read.csv(unz("activity.zip", "activity.csv"),
                   header = TRUE,
                   colClasses = c("numeric","POSIXct","numeric"))
```

## What is mean total number of steps taken per day?
```{r steps per day}
  stepsperday <- with(acdat,tapply(steps,date,sum,na.rm=T))
  binw <- (range(stepsperday,na.rm = T)[2]-range(stepsperday,na.rm = T)[1])/30
  qplot(stepsperday, binwidth =binw, xlab= "Steps per day", ylab = "Frequency")

means <- mean(stepsperday)
medians <- median(stepsperday)
  
```

The mean of the daily steps is `r sprintf("%.2f",means)` and its median, `r sprintf("%.2f",medians)`.



## What is the average daily activity pattern?

```{r time series plot}
acdat$datetime <- acdat$date+acdat$interval*60  
 ggplot(acdat, aes(datetime, steps)) + geom_line(color="steelblue")+ ylab("Number of steps") + xlab("Date/time")

maxd <- which.max(acdat$steps)
```

The 5-minute interval `r acdat[maxd,3]` on `r acdat[maxd,2]` contains the maximum number of steps (`r acdat[maxd,1]`).

## Imputing missing values

The orginal data contains some missing values`r sum(is.na(acdat$steps))`.

In order to perform an exploratory analysis, the missing values were imputed using the day average steps for all the data. The R code used is he following.


```{r missing valules}
    acdat2 <- acdat
    acdat2[is.na(acdat2$steps),1] <- mean(acdat2$steps,na.rm =T)   

  stepsperday2 <- with(acdat2,tapply(steps,date,sum,na.rm=T))
  binw2 <- (range(stepsperday2,na.rm = T)[2]-range(stepsperday2,na.rm = T)[1])/30
  qplot(stepsperday2, binwidth =binw2, xlab= "Steps per day", ylab = "Frequency")

  means2 <- mean(stepsperday2)
  medians2 <- median(stepsperday2)

```

After imputing the missing values the mean and median are `r sprintf("%.2f",means2)` and `r sprintf("%.2f",medians2)`, respectively.

## Are there differences in activity patterns between weekdays and weekends?

The activity patters differ btween weekends and midweek. this can be observe in the following plot.

```{r weekdays}
weekend <- c(weekdays(as.Date(c("19072014","20072014"),format="%d%m%Y")))
acdat2$weekday <- ifelse(weekdays(acdat2$date) %in% weekend, "weekend", "weekday")
acdat2$weekday <- as.factor(acdat2$weekday)

ggplot(acdat2, aes(interval,steps)) + geom_line(color = "steelblue") + facet_wrap(~ weekday,2) + xlab(label = "Interval") + ylab("Number fo steps")

```


